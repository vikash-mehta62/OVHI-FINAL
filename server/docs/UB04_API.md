# UB-04 Form Generation API Documentation\n\n## Overview\n\nThe UB-04 Form Generation API provides comprehensive functionality for creating compliant UB-04 forms for institutional claims. The service generates PDF forms with precise form locator positioning according to UB-04 specifications.\n\n## Base URL\n```\n/api/v1/rcm\n```\n\n## Authentication\nAll endpoints require authentication. Include the JWT token in the Authorization header:\n```\nAuthorization: Bearer <jwt_token>\n```\n\n## UB-04 Form Specifications\n\n### Form Requirements\n- **Form Type**: UB-04 - Uniform Billing Form for Institutional Claims\n- **Paper Size**: 8.5\" x 11\" (Letter size)\n- **Font**: Courier (monospace) - 10pt for data fields\n- **Form Locators**: 81 numbered positions per UB-04 specifications\n- **Maximum Revenue Lines**: 22 per form\n- **Maximum Diagnosis Codes**: 25 per form (with POA indicators)\n\n### Required Data Elements\n- Facility information including NPI and tax ID\n- Patient demographics and insurance information\n- Admission and discharge information\n- Revenue codes with charges and units\n- Diagnosis codes with Present on Admission (POA) indicators\n- Condition and occurrence codes\n- Provider information\n\n## Endpoints\n\n### 1. Generate UB-04 Form\n\nGenerate a PDF UB-04 form for a specific institutional claim.\n\n**Endpoint:** `GET /claims/{claimId}/ub04/generate`\n\n**Path Parameters:**\n- `claimId` (integer, required) - Institutional claim ID\n\n**Query Parameters:**\n- `format` (string, optional, default: 'pdf') - Output format (currently only PDF supported)\n- `includeFormBackground` (boolean, optional, default: true) - Include form background and labels\n- `isDraft` (boolean, optional, default: false) - Add draft watermark\n\n**Response:**\n- **Content-Type**: `application/pdf`\n- **Content-Disposition**: `attachment; filename=\"UB04-{claimId}.pdf\"`\n- **Body**: PDF binary data\n\n**Example Request:**\n```bash\ncurl -X GET \"/api/v1/rcm/claims/123/ub04/generate?includeFormBackground=true&isDraft=false\" \\\n  -H \"Authorization: Bearer <token>\" \\\n  -o \"UB04-123.pdf\"\n```\n\n**Error Responses:**\n```json\n{\n  \"success\": false,\n  \"message\": \"Institutional claim data validation failed\",\n  \"error\": {\n    \"code\": \"VALIDATION_ERROR\",\n    \"details\": {\n      \"errors\": [\n        \"Facility NPI is required\",\n        \"Bill type must be 4 digits\",\n        \"At least one revenue code line is required\"\n      ]\n    }\n  }\n}\n```\n\n### 2. Preview UB-04 Form Data\n\nPreview form data and validation without generating the actual PDF.\n\n**Endpoint:** `GET /claims/{claimId}/ub04/preview`\n\n**Path Parameters:**\n- `claimId` (integer, required) - Institutional claim ID\n\n**Response:**\n```json\n{\n  \"success\": true,\n  \"message\": \"UB-04 form preview generated successfully\",\n  \"data\": {\n    \"claimId\": 123,\n    \"validation\": {\n      \"isValid\": true,\n      \"errors\": [],\n      \"warnings\": [\n        \"Revenue line 1: Service units should be positive\"\n      ]\n    },\n    \"formData\": {\n      \"1_provider_name\": \"GENERAL HOSPITAL\",\n      \"2_provider_address\": \"123 HOSPITAL WAY\\nANYTOWN, CA 90210\",\n      \"3_patient_control_number\": \"H123456789\",\n      \"4_type_of_bill\": \"0111\",\n      \"5_federal_tax_number\": \"12-3456789\",\n      \"8_patient_name\": \"DOE, JOHN M\",\n      \"10_patient_birth_date\": \"01151980\",\n      \"11_patient_sex\": \"M\",\n      \"12_admission_date\": \"03152024\",\n      \"42_revenue_code_1\": \"0110\",\n      \"43_revenue_description_1\": \"Room and Board - Private\",\n      \"47_total_charges_1\": \"1500.00\",\n      \"76_attending_physician_npi\": \"1234567890\"\n    },\n    \"fieldCount\": 45,\n    \"estimatedSize\": \"~95KB\",\n    \"revenueLineCount\": 5,\n    \"diagnosisCount\": 3\n  }\n}\n```\n\n### 3. Batch Generate UB-04 Forms\n\nGenerate multiple UB-04 forms in a single request.\n\n**Endpoint:** `POST /forms/ub04/batch`\n\n**Request Body:**\n```json\n{\n  \"claimIds\": [123, 124, 125],\n  \"options\": {\n    \"includeFormBackground\": true,\n    \"isDraft\": false,\n    \"format\": \"pdf\"\n  }\n}\n```\n\n**Response:**\n```json\n{\n  \"success\": true,\n  \"message\": \"Batch UB-04 generation completed\",\n  \"data\": {\n    \"summary\": {\n      \"total\": 3,\n      \"successful\": 2,\n      \"failed\": 1,\n      \"totalSize\": 190480\n    },\n    \"results\": [\n      {\n        \"claimId\": 123,\n        \"success\": true,\n        \"size\": 95240\n      },\n      {\n        \"claimId\": 124,\n        \"success\": true,\n        \"size\": 95240\n      },\n      {\n        \"claimId\": 125,\n        \"success\": false,\n        \"error\": \"Facility NPI is required\"\n      }\n    ]\n  }\n}\n```\n\n### 4. Validate UB-04 Data\n\nValidate institutional claim data for UB-04 form generation.\n\n**Endpoint:** `GET /claims/{claimId}/ub04/validate`\n\n**Path Parameters:**\n- `claimId` (integer, required) - Institutional claim ID\n\n**Response:**\n```json\n{\n  \"success\": true,\n  \"message\": \"UB-04 validation completed\",\n  \"data\": {\n    \"claimId\": 123,\n    \"validation\": {\n      \"isValid\": false,\n      \"errors\": [\n        \"Facility NPI is required\",\n        \"Bill type must be 4 digits\"\n      ],\n      \"warnings\": [\n        \"Revenue line 1: Service units should be positive\"\n      ]\n    },\n    \"canGenerate\": false,\n    \"requiredFields\": 2,\n    \"warnings\": 1,\n    \"revenueLineCount\": 5,\n    \"diagnosisCount\": 3\n  }\n}\n```\n\n### 5. Get UB-04 Generation History\n\nRetrieve the history of UB-04 form generations for a claim.\n\n**Endpoint:** `GET /claims/{claimId}/ub04/history`\n\n**Path Parameters:**\n- `claimId` (integer, required) - Institutional claim ID\n\n**Query Parameters:**\n- `page` (integer, optional, default: 1) - Page number\n- `limit` (integer, optional, default: 20) - Items per page\n\n**Response:**\n```json\n{\n  \"success\": true,\n  \"message\": \"UB-04 generation history retrieved successfully\",\n  \"data\": {\n    \"activities\": [\n      {\n        \"id\": 1,\n        \"action_type\": \"form_generated\",\n        \"field_name\": \"ub04_form\",\n        \"old_value\": null,\n        \"new_value\": \"generated\",\n        \"user_id\": 5,\n        \"user_name\": \"John Doe\",\n        \"timestamp\": \"2024-01-15T14:30:00Z\",\n        \"notes\": \"UB-04 form generated successfully\",\n        \"metadata\": {\n          \"form_type\": \"UB-04\",\n          \"success\": true,\n          \"options\": {\n            \"includeFormBackground\": true,\n            \"isDraft\": false\n          }\n        }\n      }\n    ],\n    \"pagination\": {\n      \"page\": 1,\n      \"limit\": 20,\n      \"total\": 3,\n      \"totalPages\": 1,\n      \"hasNext\": false,\n      \"hasPrev\": false\n    }\n  }\n}\n```\n\n### 6. Validate Revenue Code\n\nValidate a specific revenue code.\n\n**Endpoint:** `POST /ub04/validate-revenue-code`\n\n**Request Body:**\n```json\n{\n  \"revenueCode\": \"0110\"\n}\n```\n\n**Response:**\n```json\n{\n  \"success\": true,\n  \"message\": \"Revenue code validation completed\",\n  \"data\": {\n    \"revenueCode\": \"0110\",\n    \"isValid\": true,\n    \"description\": \"Room and Board - Private\",\n    \"category\": \"Room and Board\"\n  }\n}\n```\n\n### 7. Validate Bill Type\n\nValidate a bill type code.\n\n**Endpoint:** `POST /ub04/validate-bill-type`\n\n**Request Body:**\n```json\n{\n  \"billType\": \"0111\"\n}\n```\n\n**Response:**\n```json\n{\n  \"success\": true,\n  \"message\": \"Bill type validation completed\",\n  \"data\": {\n    \"billType\": \"0111\",\n    \"isValid\": true,\n    \"errors\": [],\n    \"facilityType\": \"Hospital\",\n    \"billClassification\": \"1\",\n    \"frequency\": \"1\"\n  }\n}\n```\n\n## Form Locator Reference\n\n### UB-04 Form Locator Mapping\n\n| FL | Field Name | Description | Required | Max Length |\n|----|------------|-------------|----------|------------|\n| 1 | Provider Name | Facility name | Yes | 60 |\n| 2 | Provider Address | Facility address | Yes | 60 |\n| 3 | Patient Control Number | Internal patient ID | Yes | 20 |\n| 4 | Type of Bill | 4-digit bill type code | Yes | 4 |\n| 5 | Federal Tax Number | Facility tax ID | Yes | 15 |\n| 8 | Patient Name | Patient full name | Yes | 25 |\n| 9 | Patient Address | Patient address | Yes | 60 |\n| 10 | Patient Birth Date | MMDDYYYY format | Yes | 8 |\n| 11 | Patient Sex | M/F/U | Yes | 1 |\n| 12 | Admission Date | MMDDYYYY format | Yes | 8 |\n| 13 | Admission Hour | HH format | No | 2 |\n| 14 | Type of Admission | Admission type code | No | 1 |\n| 15 | Source of Admission | Source code | No | 1 |\n| 16 | Discharge Hour | HH format | No | 2 |\n| 17 | Patient Status | Discharge status | No | 2 |\n| 18-28 | Condition Codes | Condition codes | No | 2 each |\n| 31-34 | Occurrence Codes | Occurrence codes and dates | No | 2+8 each |\n| 35-36 | Occurrence Span Codes | Span codes and dates | No | 2+8+8 each |\n| 37 | Internal Control Number | Facility control number | No | 20 |\n| 38 | Responsible Party | Responsible party info | No | 30 |\n| 39-41 | Value Codes | Value codes and amounts | No | 2+12 each |\n| 42 | Revenue Code | 4-digit revenue code | Yes | 4 |\n| 43 | Revenue Description | Revenue description | No | 30 |\n| 44 | HCPCS/Rates | HCPCS codes | No | 10 |\n| 45 | Service Date | Service date | No | 8 |\n| 46 | Service Units | Units of service | No | 7 |\n| 47 | Total Charges | Line total charges | Yes | 12 |\n| 48 | Non-Covered Charges | Non-covered amounts | No | 12 |\n| 49 | Reserved | Reserved for future use | No | - |\n| 50 | Payer Name | Insurance company name | Yes | 30 |\n| 51 | Health Plan ID | Payer identifier | No | 20 |\n| 52 | Release of Information | Y/N/I | No | 1 |\n| 53 | Assignment of Benefits | Y/N | No | 1 |\n| 54 | Prior Payments | Previous payments | No | 12 |\n| 55 | Estimated Amount Due | Estimated balance | No | 12 |\n| 56 | Total Charges | Sum of all charges | Yes | 12 |\n| 57 | Reserved | Reserved for future use | No | - |\n| 58 | Insured's Name | Primary insured name | No | 25 |\n| 59 | Patient's Relationship | Relationship code | No | 2 |\n| 60 | Insured's Unique ID | Insured identifier | No | 20 |\n| 61 | Insured's Group Name | Group name | No | 20 |\n| 62 | Insurance Group Number | Group number | No | 20 |\n| 63 | Treatment Authorization | Auth codes | No | 30 |\n| 64 | Document Control Number | Control number | No | 20 |\n| 65 | Employer Name | Employer information | No | 25 |\n| 66-75 | Diagnosis Codes | ICD-10-CM codes | Yes | 7 each |\n| 76 | Attending Physician NPI | Attending physician | Yes | 10 |\n| 77 | Operating Physician NPI | Operating physician | No | 10 |\n| 78 | Other Physician NPI | Other physician | No | 10 |\n| 79 | Other Physician NPI | Additional physician | No | 10 |\n| 80 | Remarks | Additional information | No | 80 |\n| 81 | Code-Code Field | Special codes | No | 4 |\n\n## Revenue Code Categories\n\n### Major Revenue Code Categories\n\n| Range | Category | Description |\n|-------|----------|-------------|\n| 0100-0199 | All Inclusive Rate | Room, board, and ancillary services |\n| 0200-0299 | Intensive Care | ICU, CCU, and special care units |\n| 0300-0399 | Laboratory | Clinical lab services |\n| 0400-0499 | Radiology | Diagnostic and therapeutic radiology |\n| 0500-0599 | Nuclear Medicine | Nuclear medicine services |\n| 0600-0699 | Operating Room | OR services and supplies |\n| 0700-0799 | Anesthesia | Anesthesia services |\n| 0800-0899 | Blood | Blood and blood products |\n| 0900-0999 | Drugs | Pharmaceuticals |\n\n### Common Revenue Codes\n\n| Code | Description | Category |\n|------|-------------|----------|\n| 0110 | Room and Board - Private | Accommodation |\n| 0111 | Room and Board - Private - Medical/General | Accommodation |\n| 0120 | Room and Board - Semi-Private | Accommodation |\n| 0130 | Room and Board - Ward | Accommodation |\n| 0140 | Room and Board - ICU | Intensive Care |\n| 0200 | Intensive Care Unit | Intensive Care |\n| 0300 | Laboratory | Laboratory |\n| 0320 | Radiology - Diagnostic | Radiology |\n| 0360 | Operating Room Services | Operating Room |\n| 0370 | Anesthesia | Anesthesia |\n| 0380 | Blood | Blood Products |\n| 0450 | Emergency Room | Emergency |\n| 0636 | Drugs - General Classification | Pharmacy |\n\n## Bill Type Codes\n\n### Bill Type Structure (4 digits: XYZW)\n\n**First Digit (X) - Type of Facility:**\n- 1 = Hospital\n- 2 = Skilled Nursing Facility\n- 3 = Home Health Agency\n- 4 = Religious Non-Medical Health Care Institution\n- 6 = Intermediate Care Facility\n- 7 = Clinic or Hospital-Based Renal Dialysis Facility\n- 8 = Special Facility or ASC\n\n**Second Digit (Y) - Bill Classification:**\n- 1 = Inpatient (including Medicare Part A)\n- 2 = Inpatient (Medicare Part B only)\n- 3 = Outpatient\n- 4 = Other (for other types of bills)\n\n**Third Digit (Z) - Frequency:**\n- 1 = Admit thru Discharge Claim\n- 2 = Interim - First Claim\n- 3 = Interim - Continuing Claim\n- 4 = Interim - Last Claim\n- 5 = Late Charge(s) Only Claim\n- 7 = Replacement of Prior Claim\n- 8 = Void/Cancel of Prior Claim\n- 9 = Final Claim for HH PPS Episode\n\n**Fourth Digit (W) - Reserved (usually 0 or 1)**\n\n### Common Bill Types\n\n| Code | Description |\n|------|-------------|\n| 0111 | Hospital Inpatient - Admit thru Discharge |\n| 0112 | Hospital Inpatient - Interim First |\n| 0113 | Hospital Inpatient - Interim Continuing |\n| 0114 | Hospital Inpatient - Interim Last |\n| 0117 | Hospital Inpatient - Replacement |\n| 0131 | Hospital Outpatient - Admit thru Discharge |\n| 0211 | SNF Inpatient - Admit thru Discharge |\n| 0311 | Home Health - Admit thru Discharge |\n| 0831 | ASC Outpatient - Admit thru Discharge |\n\n## Condition Codes\n\n### Common Condition Codes\n\n| Code | Description |\n|------|-------------|\n| 01 | Military service related |\n| 02 | Condition is employment related |\n| 04 | Information only bill |\n| 07 | Treatment of non-terminal condition for hospice patient |\n| 20 | Beneficiary requested billing |\n| 21 | Billing for Denial Notice |\n| 40 | Same day transfer |\n| 41 | Partial hospitalization |\n| 44 | Inpatient admission changed to outpatient |\n| 55 | SNF bed not available |\n| 56 | Medical appropriateness |\n| 57 | SNF readmission |\n| 60 | Day outlier |\n| 61 | Cost outlier |\n| 67 | Beneficiary elects not to use LTR days |\n| 68 | Beneficiary elects to use LTR days |\n\n## Occurrence Codes\n\n### Common Occurrence Codes\n\n| Code | Description |\n|------|-------------|\n| 01 | Accident/medical coverage |\n| 02 | No fault insurance involved |\n| 11 | Onset of symptoms/illness |\n| 18 | Date of retirement patient/beneficiary |\n| 24 | Date insurance denied |\n| 27 | Date of hospice certification |\n| 31 | Date beneficiary notified of intent to bill |\n| 35 | Date treatment started for P.T. |\n| 40 | Scheduled date of admission |\n| 42 | Date of discharge |\n| A1 | Birthdate - insured A |\n| A2 | Effective date - insured A policy |\n| A3 | Benefits exhausted payer A |\n\n## Validation Rules\n\n### Required Fields Validation\n- Facility name, NPI, and tax ID\n- Patient name, DOB, gender, and complete address\n- Bill type (4 digits) and patient control number\n- Admission date and attending physician NPI\n- At least one diagnosis code with POA indicator\n- At least one revenue code line with valid charges\n\n### Format Validation\n- **Dates**: MMDDYYYY format (8 digits)\n- **NPI Numbers**: Exactly 10 digits\n- **Bill Type**: Exactly 4 digits with valid components\n- **Revenue Codes**: Exactly 4 digits\n- **Condition Codes**: 2 digits or characters\n- **Occurrence Codes**: 2 digits or characters\n\n### Business Rules\n- Maximum 22 revenue code lines per form\n- Maximum 25 diagnosis codes per form\n- Principal diagnosis must be present\n- POA indicators required for all diagnoses\n- Revenue code totals must balance\n- Bill type components must be valid\n\n## Error Handling\n\n### Common Error Codes\n\n| Code | Description | Resolution |\n|------|-------------|------------|\n| `VALIDATION_ERROR` | Required field missing or invalid format | Check validation response for specific errors |\n| `CLAIM_NOT_FOUND` | Institutional claim ID does not exist | Verify claim ID and claim type |\n| `INSUFFICIENT_DATA` | Not enough data to generate form | Complete required institutional claim information |\n| `INVALID_BILL_TYPE` | Bill type format or components invalid | Use valid 4-digit bill type code |\n| `INVALID_REVENUE_CODE` | Revenue code not recognized | Use valid 4-digit revenue code |\n| `GENERATION_FAILED` | PDF generation failed | Check server logs, retry request |\n\n## Rate Limiting\n\n- **Individual form generation**: 60 requests per minute\n- **Batch generation**: 10 requests per minute\n- **Preview/validation**: 120 requests per minute\n- **Code validation**: 200 requests per minute\n\n## Best Practices\n\n### Form Generation\n1. **Validate first**: Always validate institutional claim data before generating forms\n2. **Use preview**: Preview forms to check formatting and completeness\n3. **Batch processing**: Use batch generation for multiple institutional claims\n4. **Revenue code validation**: Validate revenue codes before submission\n\n### Data Quality\n1. **Complete diagnosis coding**: Include all relevant diagnoses with POA indicators\n2. **Accurate revenue coding**: Use specific revenue codes for services provided\n3. **Proper bill typing**: Select appropriate bill type for claim circumstances\n4. **Condition codes**: Include relevant condition codes for claim processing\n\n### Performance Optimization\n1. **Cache validation**: Cache validation results for frequently accessed claims\n2. **Async processing**: Use background jobs for large batch operations\n3. **Data preparation**: Ensure institutional claim data is complete before generation\n4. **Error handling**: Implement proper retry logic for transient failures\n\n## Integration Examples\n\n### JavaScript/Node.js\n```javascript\nconst axios = require('axios');\nconst fs = require('fs');\n\n// Generate UB-04 form\nasync function generateUB04(claimId, token) {\n  try {\n    const response = await axios({\n      method: 'GET',\n      url: `/api/v1/rcm/claims/${claimId}/ub04/generate`,\n      headers: {\n        'Authorization': `Bearer ${token}`\n      },\n      responseType: 'arraybuffer'\n    });\n    \n    // Save PDF to file\n    fs.writeFileSync(`UB04-${claimId}.pdf`, response.data);\n    console.log('UB-04 form generated successfully');\n  } catch (error) {\n    console.error('Generation failed:', error.response?.data);\n  }\n}\n\n// Validate revenue code\nasync function validateRevenueCode(revenueCode, token) {\n  try {\n    const response = await axios.post(\n      '/api/v1/rcm/ub04/validate-revenue-code',\n      { revenueCode },\n      { headers: { 'Authorization': `Bearer ${token}` } }\n    );\n    \n    const { isValid, description, category } = response.data.data;\n    console.log(`Revenue Code ${revenueCode}:`, {\n      valid: isValid,\n      description,\n      category\n    });\n  } catch (error) {\n    console.error('Validation failed:', error.message);\n  }\n}\n```\n\n### Python\n```python\nimport requests\n\ndef generate_ub04(claim_id, token):\n    headers = {'Authorization': f'Bearer {token}'}\n    \n    # Validate first\n    validation_url = f'/api/v1/rcm/claims/{claim_id}/ub04/validate'\n    validation_response = requests.get(validation_url, headers=headers)\n    \n    if validation_response.json()['data']['canGenerate']:\n        # Generate form\n        generate_url = f'/api/v1/rcm/claims/{claim_id}/ub04/generate'\n        pdf_response = requests.get(generate_url, headers=headers)\n        \n        # Save PDF\n        with open(f'UB04-{claim_id}.pdf', 'wb') as f:\n            f.write(pdf_response.content)\n        \n        print('UB-04 form generated successfully')\n    else:\n        errors = validation_response.json()['data']['validation']['errors']\n        print(f'Validation errors: {errors}')\n\ndef validate_bill_type(bill_type, token):\n    headers = {'Authorization': f'Bearer {token}'}\n    \n    response = requests.post(\n        '/api/v1/rcm/ub04/validate-bill-type',\n        json={'billType': bill_type},\n        headers=headers\n    )\n    \n    data = response.json()['data']\n    print(f\"Bill Type {bill_type}: {'Valid' if data['isValid'] else 'Invalid'}\")\n    if data['isValid']:\n        print(f\"Facility: {data['facilityType']}\")\n        print(f\"Classification: {data['billClassification']}\")\n        print(f\"Frequency: {data['frequency']}\")\n```\n\n## Troubleshooting\n\n### Common Issues\n\n1. **\"Facility NPI is required\"**\n   - Ensure facility has valid 10-digit NPI in system\n   - Check facility assignment to institutional claim\n\n2. **\"Bill type must be 4 digits\"**\n   - Verify bill type format (XYZW)\n   - Check each digit against valid values\n\n3. **\"Invalid revenue code format\"**\n   - Ensure revenue codes are exactly 4 digits\n   - Verify codes exist in revenue code table\n\n4. **\"Principal diagnosis is required\"**\n   - Ensure at least one diagnosis is marked as principal\n   - Check diagnosis type field in database\n\n5. **\"POA indicator is recommended\"**\n   - Add Present on Admission indicators for all diagnoses\n   - Use Y, N, U, W, or 1 for POA values\n\n### Support\n\nFor technical support or questions about the UB-04 API:\n- Check the validation endpoint for specific error details\n- Review the preview endpoint to verify data formatting\n- Consult the generation history for previous successful attempts\n- Validate revenue codes and bill types using dedicated endpoints"